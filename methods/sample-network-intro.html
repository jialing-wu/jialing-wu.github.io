---
layout: methods-course
title: "Introduction to Network Analysis"
breadcrumb: "Sample"
bilingual: true
---

<style>
/* ══════════════════════════════════════════════════════
   PRESENTATION MODE
   ══════════════════════════════════════════════════════ */

/* Toggle button */
.pres-toggle{
  display:inline-flex;align-items:center;gap:8px;
  font-family:var(--sans);font-size:12px;font-weight:600;
  letter-spacing:.06em;text-transform:uppercase;
  color:var(--gold);background:var(--warm);
  border:1px solid var(--parchment);border-radius:4px;
  padding:8px 18px;cursor:pointer;transition:all .2s;
  margin-bottom:20px;
}
.pres-toggle:hover{background:var(--gold);color:var(--paper);border-color:var(--gold)}
.pres-toggle .pres-icon{font-size:16px}

/* Hide chrome */
body.presenting .sidebar,
body.presenting .sidebar-overlay,
body.presenting .topbar,
body.presenting .page-toc,
body.presenting .pres-toggle,
body.presenting .page-nav,
body.presenting .pres-hide{display:none!important}

body.presenting .layout{display:block}
body.presenting .main{margin:0;padding:0;width:100vw}
body.presenting .content{max-width:100vw!important;padding:0!important;margin:0!important}

/* Slide container */
body.presenting .slide{
  display:none;width:100vw;height:100vh;
  padding:48px 0;box-sizing:border-box;
  overflow-y:auto;background:var(--paper);
}
body.presenting .slide.active{
  display:flex;flex-direction:column;
  justify-content:center;align-items:center;
}
/* Max-width centering for all children */
body.presenting .slide > *{
  width:100%;max-width:880px;
  padding-left:40px;padding-right:40px;
  box-sizing:border-box;
}

/* Presentation typography */
body.presenting .slide .slide-num{font-size:11px;margin-bottom:8px}
body.presenting .slide h2{font-size:2.2rem;margin-bottom:20px;line-height:1.25;letter-spacing:-.01em}
body.presenting .slide h3{font-size:1.5rem;margin-bottom:12px}
body.presenting .slide p,
body.presenting .slide li{font-size:1.1rem;line-height:1.9}
body.presenting .slide .method-desc{font-size:1.1rem;line-height:1.9;margin-bottom:16px}
body.presenting .slide .method-analogy{font-size:1.05rem;line-height:1.8}
body.presenting .slide .method-when{font-size:1.05rem;line-height:1.8}

/* Presentation: vis panels */
body.presenting .vis-panel{padding:24px 28px}
body.presenting .vis-panel svg{max-width:420px;margin:0 auto;display:block}
body.presenting .vis-caption{font-size:13px;margin-top:12px}
body.presenting .vis-label{font-size:12px}

/* Presentation: check cards */
body.presenting .check-grid{gap:20px;margin:24px 0}
body.presenting .check-card{padding:22px 20px}
body.presenting .check-icon{width:32px;height:32px;font-size:12px;margin-bottom:12px}
body.presenting .check-title{font-size:14px;margin-bottom:8px}
body.presenting .check-desc{font-size:13.5px;line-height:1.65}

/* Presentation: flow diagram */
body.presenting .flow-step{padding:14px 22px;min-width:130px}
body.presenting .flow-step .flow-title{font-size:15px}
body.presenting .flow-arrow{font-size:22px;padding:0 8px}

/* Presentation: centrality */
body.presenting .cent-btns{margin:12px 0 16px}
body.presenting .cent-btn{font-size:13px;padding:8px 20px}

/* Presentation: step details */
body.presenting .step-item{font-size:1rem;line-height:1.8;padding:6px 16px}

/* Slide counter, ESC hint, progress bar */
body.presenting .slide-counter{
  position:fixed;bottom:24px;right:32px;
  font-family:var(--sans);font-size:13px;
  color:var(--ink-ghost);letter-spacing:.05em;z-index:999;
}
body.presenting .pres-esc{
  position:fixed;top:20px;right:28px;
  font-family:var(--sans);font-size:11px;
  color:var(--ink-ghost);letter-spacing:.05em;
  opacity:.6;z-index:999;
}
body.presenting .pres-progress{
  position:fixed;top:0;left:0;height:3px;
  background:var(--gold);z-index:999;
  transition:width .3s ease;
}

/* ══════════════════════════════════════════════════════
   NORMAL MODE — PAGE-SPECIFIC COMPONENTS
   (all scoped to avoid conflicts with style.css)
   ══════════════════════════════════════════════════════ */

/* Section number badge */
.slide-num{
  font-family:var(--sans);font-size:11px;font-weight:700;
  letter-spacing:.12em;text-transform:uppercase;
  color:var(--gold);margin-bottom:12px;
}

/* ── Visualization panels ─────────────────────────── */
.vis-row{
  display:flex;gap:20px;margin:24px 0;
  flex-wrap:wrap;align-items:stretch;
}
.vis-panel{
  flex:1;min-width:220px;
  background:var(--warm);border:1px solid var(--parchment);
  border-radius:6px;padding:18px 20px;text-align:center;
  display:flex;flex-direction:column;
}
.vis-panel svg{
  max-width:100%;height:auto;margin:4px auto 0;
  display:block;flex:1;min-height:0;
}
.vis-label{
  font-family:var(--sans);font-size:11px;font-weight:700;
  letter-spacing:.1em;text-transform:uppercase;
  color:var(--gold);margin-bottom:8px;flex-shrink:0;
}
.vis-caption{
  font-family:var(--sans);font-size:11.5px;
  color:var(--ink-faded);margin-top:10px;line-height:1.5;flex-shrink:0;
}

/* ── Centrality interactive ───────────────────────── */
.cent-btns{display:flex;gap:8px;flex-wrap:wrap;margin:12px 0 16px}
.cent-btn{
  font-family:var(--sans);font-size:12px;font-weight:600;
  padding:6px 16px;border:1px solid var(--parchment);border-radius:4px;
  background:var(--warm);color:var(--ink-faded);cursor:pointer;
  transition:all .2s;
}
.cent-btn:hover,.cent-btn.active{background:var(--gold);color:var(--paper);border-color:var(--gold)}

/* Centrality detail box — override .method-desc base */
#cent-detail-en,
#cent-detail-zh{
  background:var(--warm);
  border-left:3px solid var(--gold);border:1px solid var(--parchment);
  border-left:3px solid var(--gold);
  padding:14px 18px;border-radius:0 4px 4px 0;
  margin:16px 0 12px;
}

/* ── Flow diagram ─────────────────────────────────── */
.flow-row{
  display:flex;align-items:center;gap:0;
  margin:24px 0;flex-wrap:wrap;justify-content:center;
}
.flow-step{
  background:var(--warm);border:1px solid var(--parchment);
  border-radius:6px;padding:12px 18px;text-align:center;min-width:110px;
}
.flow-step .flow-num{font-family:var(--sans);font-size:10px;font-weight:700;color:var(--gold);letter-spacing:.1em}
.flow-step .flow-title{font-family:var(--body);font-size:14px;color:var(--ink);margin-top:4px}
.flow-arrow{font-size:18px;color:var(--gold);padding:0 6px}

/* ── Decision checklist ───────────────────────────── */
.check-grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:14px;margin:20px 0}
.check-card{
  background:var(--warm);border:1px solid var(--parchment);
  border-radius:6px;padding:18px 16px;
  text-align:left;
}
.check-icon{
  font-family:var(--sans);font-size:11px;font-weight:700;
  letter-spacing:.1em;text-transform:uppercase;
  color:var(--paper);background:var(--gold);
  display:inline-flex;align-items:center;justify-content:center;
  width:28px;height:28px;border-radius:4px;margin-bottom:10px;
}
.check-title{font-family:var(--sans);font-size:12.5px;font-weight:600;color:var(--ink);margin-bottom:6px}
.check-desc{font-family:var(--sans);font-size:12px;color:var(--ink-faded);line-height:1.6}

/* ── Step details (workflow breakdown) ─────────────── */
.step-details{display:grid;grid-template-columns:1fr;gap:6px;margin:16px 0}
.step-item{
  font-size:14px;line-height:1.7;color:var(--ink-faded);
  padding:8px 14px;
  border-left:2px solid var(--parchment);
  transition:border-color .2s;
}
.step-item:hover{border-left-color:var(--gold)}
.step-item strong{color:var(--ink-soft)}

/* ── method-when (not in style.css — define from scratch) */
.method-when{
  margin:12px 0;padding:10px 14px;border-radius:4px;
  background:rgba(90,122,107,.05);border:1px solid rgba(90,122,107,.2);
  font-size:14.5px;line-height:1.65;color:var(--ink-faded);
}
.method-when strong{color:var(--leather);font-style:normal}

/* ── Override intro-cards to 2-col for this page (has 2 cards, not 3) */
.intro-cards{grid-template-columns:1fr 1fr!important}

/* ── Responsive ───────────────────────────────────── */
@media(max-width:1000px){
  .check-grid{grid-template-columns:1fr 1fr}
}
@media(max-width:700px){
  .flow-row{flex-direction:column;gap:4px}
  .flow-arrow{transform:rotate(90deg);padding:2px 0}
  .check-grid{grid-template-columns:1fr}
  .vis-row{flex-direction:column}
  .vis-panel{min-width:100%}
  .intro-cards{grid-template-columns:1fr!important}
  body.presenting .slide > *{padding-left:24px;padding-right:24px}
}
@media(max-width:900px){
  body.presenting .slide h2{font-size:1.8rem}
  body.presenting .slide .method-desc{font-size:1rem}
  body.presenting .check-desc{font-size:12px}
}
</style>

<!-- PRESENTATION TOGGLE -->
<button class="pres-toggle" onclick="togglePresentation()">
  <span class="pres-icon">▶</span>
  <span data-lang="en">Presentation Mode</span>
  <span data-lang="zh">演示模式</span>
</button>

<!-- HEADER -->
<div class="slide" id="slide-title">
  <div class="method-header">
    <h1 data-lang="en">Introduction to Network Analysis</h1>
    <h1 data-lang="zh">网络分析入门</h1>
    <div class="method-meta">Sample · 15–20 min</div>
  </div>
  <div class="intro-cards">
    <div class="intro-card">
      <div class="card-label" data-lang="en">What Is This?</div>
      <div class="card-label" data-lang="zh">这是什么？</div>
      <div data-lang="en"><p>A practical introduction to network analysis for social scientists. Part 1 covers the core concepts; Part 2 walks through a published paper step by step. Designed for a 15–20 minute presentation.</p></div>
      <div data-lang="zh"><p>面向社会科学研究者的网络分析实用入门。第一部分讲核心概念；第二部分逐步拆解一篇发表论文。设计为 15–20 分钟演示。</p></div>
    </div>
    <div class="intro-card">
      <div class="card-label" data-lang="en">Audience</div>
      <div class="card-label" data-lang="zh">受众</div>
      <div data-lang="en"><p>Graduate students across disciplines. No network analysis background assumed; basic familiarity with regression is helpful.</p></div>
      <div data-lang="zh"><p>跨学科研究生。无需网络分析背景；了解回归分析基础即可。</p></div>
    </div>
  </div>
</div>

<hr class="section-divider pres-hide">

<!-- ═══════════════════════════════════════════════════ -->
<!--  PART 1: WHAT IS NETWORK ANALYSIS?                 -->
<!-- ═══════════════════════════════════════════════════ -->

<!-- SLIDE: Why Relationships -->
<div class="slide" id="slide-why">
  <div class="slide-num" data-lang="en">Part 1 · Slide 1</div>
  <div class="slide-num" data-lang="zh">第一部分 · 第 1 页</div>
  <h2 data-lang="en">Why Study Relationships, Not Just Individuals?</h2>
  <h2 data-lang="zh">为什么要研究关系，而不只是个体？</h2>

  <p class="method-desc" data-lang="en">Most methods treat observations as independent rows. But many social phenomena are relational — who asks whom for study help reveals hidden learning communities that GPA alone cannot explain. Network analysis shifts the question from "what are this person's attributes?" to "what is their position in a web of relationships?"</p>
  <p class="method-desc" data-lang="zh">大多数方法把观测当作独立的行。但许多社会现象是关系性的——谁找谁请教功课揭示了 GPA 无法解释的隐性学习社群。网络分析把问题从"这个人有什么属性？"转变为"这个人在关系网中处于什么位置？"</p>

  <!-- VIS: Spreadsheet vs Network -->
  <div class="vis-row">
    <div class="vis-panel">
      <div class="vis-label" data-lang="en">Traditional Data</div>
      <div class="vis-label" data-lang="zh">传统数据</div>
      <svg viewBox="0 0 260 150" xmlns="http://www.w3.org/2000/svg" style="font-family:'IBM Plex Sans',sans-serif">
        <rect x="10" y="8" width="240" height="28" rx="3" fill="#c29a3d" opacity=".15"/>
        <text x="30" y="27" font-size="11" fill="#3a3632" font-weight="600">Name</text>
        <text x="110" y="27" font-size="11" fill="#3a3632" font-weight="600">Age</text>
        <text x="175" y="27" font-size="11" fill="#3a3632" font-weight="600">GPA</text>
        <line x1="10" y1="36" x2="250" y2="36" stroke="#c29a3d" opacity=".3"/>
        <text x="30" y="55" font-size="11" fill="#6b6560">Alice</text><text x="110" y="55" font-size="11" fill="#6b6560">22</text><text x="175" y="55" font-size="11" fill="#6b6560">3.8</text>
        <text x="30" y="75" font-size="11" fill="#6b6560">Bob</text><text x="110" y="75" font-size="11" fill="#6b6560">23</text><text x="175" y="75" font-size="11" fill="#6b6560">3.5</text>
        <text x="30" y="95" font-size="11" fill="#6b6560">Carol</text><text x="110" y="95" font-size="11" fill="#6b6560">21</text><text x="175" y="95" font-size="11" fill="#6b6560">3.9</text>
        <text x="30" y="115" font-size="11" fill="#6b6560">Dave</text><text x="110" y="115" font-size="11" fill="#6b6560">24</text><text x="175" y="115" font-size="11" fill="#6b6560">3.2</text>
        <text x="30" y="135" font-size="11" fill="#6b6560">Eve</text><text x="110" y="135" font-size="11" fill="#6b6560">22</text><text x="175" y="135" font-size="11" fill="#6b6560">3.6</text>
      </svg>
      <div class="vis-caption" data-lang="en">Each row = one person, independent</div>
      <div class="vis-caption" data-lang="zh">每行 = 一个人，互相独立</div>
    </div>
    <div class="vis-panel">
      <div class="vis-label" data-lang="en">Network Data</div>
      <div class="vis-label" data-lang="zh">网络数据</div>
      <svg viewBox="0 0 260 150" xmlns="http://www.w3.org/2000/svg" style="font-family:'IBM Plex Sans',sans-serif">
        <line x1="70" y1="45" x2="140" y2="40" stroke="#c29a3d" stroke-width="2" opacity=".5"/>
        <line x1="70" y1="45" x2="100" y2="100" stroke="#c29a3d" stroke-width="2" opacity=".5"/>
        <line x1="140" y1="40" x2="100" y2="100" stroke="#c29a3d" stroke-width="2" opacity=".5"/>
        <line x1="140" y1="40" x2="190" y2="90" stroke="#c29a3d" stroke-width="2" opacity=".5"/>
        <line x1="190" y1="90" x2="230" y2="130" stroke="#c29a3d" stroke-width="2" opacity=".5"/>
        <circle cx="70" cy="45" r="16" fill="#c29a3d" opacity=".2" stroke="#c29a3d" stroke-width="1.5"/>
        <text x="70" y="49" font-size="10" fill="#3a3632" text-anchor="middle" font-weight="600">Alice</text>
        <circle cx="140" cy="40" r="18" fill="#c29a3d" opacity=".35" stroke="#c29a3d" stroke-width="1.5"/>
        <text x="140" y="44" font-size="10" fill="#3a3632" text-anchor="middle" font-weight="600">Bob</text>
        <circle cx="100" cy="100" r="16" fill="#c29a3d" opacity=".2" stroke="#c29a3d" stroke-width="1.5"/>
        <text x="100" y="104" font-size="10" fill="#3a3632" text-anchor="middle" font-weight="600">Carol</text>
        <circle cx="190" cy="90" r="16" fill="#c29a3d" opacity=".2" stroke="#c29a3d" stroke-width="1.5"/>
        <text x="190" y="94" font-size="10" fill="#3a3632" text-anchor="middle" font-weight="600">Dave</text>
        <circle cx="230" cy="130" r="14" fill="#c29a3d" opacity=".12" stroke="#c29a3d" stroke-width="1.5"/>
        <text x="230" y="134" font-size="10" fill="#3a3632" text-anchor="middle" font-weight="600">Eve</text>
      </svg>
      <div class="vis-caption" data-lang="en">Relationships create structure</div>
      <div class="vis-caption" data-lang="zh">关系创造结构</div>
    </div>
  </div>

  <div class="method-analogy" data-lang="en"><strong>Think of it this way:</strong> A resume tells you about a person. A phone log tells you about their world.</div>
  <div class="method-analogy" data-lang="zh"><strong>换个方式想：</strong>简历告诉你一个人。通话记录告诉你他的世界。</div>
</div>

<!-- SLIDE: Core Vocabulary -->
<div class="slide" id="slide-vocab">
  <div class="slide-num" data-lang="en">Part 1 · Slide 2</div>
  <div class="slide-num" data-lang="zh">第一部分 · 第 2 页</div>
  <h2 data-lang="en">The Language of Networks</h2>
  <h2 data-lang="zh">网络的语言</h2>

  <p class="method-desc" data-lang="en">A network has two building blocks: <strong>nodes</strong> (actors) and <strong>edges</strong> (relationships). Mathematically, a network is a graph <em>G = (V, E)</em> where <em>V</em> is the vertex set and <em>E</em> the edge set. Everything else builds on these two. Three key distinctions:</p>
  <p class="method-desc" data-lang="zh">网络有两个基本构件：<strong>节点</strong>（行动者）和<strong>边</strong>（关系）。数学上，网络是一个图 <em>G = (V, E)</em>，其中 <em>V</em> 是顶点集，<em>E</em> 是边集。其他一切都建立在这两者之上。三个关键区分：</p>

  <!-- VIS: Three network types -->
  <div class="vis-row">
    <div class="vis-panel">
      <div class="vis-label" data-lang="en">Undirected</div>
      <div class="vis-label" data-lang="zh">无向</div>
      <svg viewBox="0 0 160 100" xmlns="http://www.w3.org/2000/svg">
        <line x1="40" y1="30" x2="120" y2="30" stroke="#c29a3d" stroke-width="2"/>
        <line x1="40" y1="30" x2="80" y2="80" stroke="#c29a3d" stroke-width="2"/>
        <line x1="120" y1="30" x2="80" y2="80" stroke="#c29a3d" stroke-width="2"/>
        <circle cx="40" cy="30" r="12" fill="#c29a3d" opacity=".25" stroke="#c29a3d" stroke-width="1.5"/>
        <circle cx="120" cy="30" r="12" fill="#c29a3d" opacity=".25" stroke="#c29a3d" stroke-width="1.5"/>
        <circle cx="80" cy="80" r="12" fill="#c29a3d" opacity=".25" stroke="#c29a3d" stroke-width="1.5"/>
        <text x="40" y="34" font-size="10" fill="#3a3632" text-anchor="middle" font-weight="600" font-family="'IBM Plex Sans',sans-serif">A</text>
        <text x="120" y="34" font-size="10" fill="#3a3632" text-anchor="middle" font-weight="600" font-family="'IBM Plex Sans',sans-serif">B</text>
        <text x="80" y="84" font-size="10" fill="#3a3632" text-anchor="middle" font-weight="600" font-family="'IBM Plex Sans',sans-serif">C</text>
      </svg>
      <div class="vis-caption" data-lang="en">Symmetric adjacency matrix (A<sub>ij</sub> = A<sub>ji</sub>). E.g. co-authorship.</div>
      <div class="vis-caption" data-lang="zh">对称邻接矩阵（A<sub>ij</sub> = A<sub>ji</sub>）。如：合著关系。</div>
    </div>
    <div class="vis-panel">
      <div class="vis-label" data-lang="en">Directed</div>
      <div class="vis-label" data-lang="zh">有向</div>
      <svg viewBox="0 0 160 100" xmlns="http://www.w3.org/2000/svg">
        <defs><marker id="arr" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto"><path d="M0,0 L10,5 L0,10 Z" fill="#c29a3d"/></marker></defs>
        <line x1="52" y1="30" x2="108" y2="30" stroke="#c29a3d" stroke-width="2" marker-end="url(#arr)"/>
        <line x1="46" y1="40" x2="74" y2="72" stroke="#c29a3d" stroke-width="2" marker-end="url(#arr)"/>
        <line x1="86" y1="72" x2="114" y2="40" stroke="#c29a3d" stroke-width="2" marker-end="url(#arr)"/>
        <circle cx="40" cy="30" r="12" fill="#c29a3d" opacity=".25" stroke="#c29a3d" stroke-width="1.5"/>
        <circle cx="120" cy="30" r="12" fill="#c29a3d" opacity=".25" stroke="#c29a3d" stroke-width="1.5"/>
        <circle cx="80" cy="80" r="12" fill="#c29a3d" opacity=".25" stroke="#c29a3d" stroke-width="1.5"/>
        <text x="40" y="34" font-size="10" fill="#3a3632" text-anchor="middle" font-weight="600" font-family="'IBM Plex Sans',sans-serif">A</text>
        <text x="120" y="34" font-size="10" fill="#3a3632" text-anchor="middle" font-weight="600" font-family="'IBM Plex Sans',sans-serif">B</text>
        <text x="80" y="84" font-size="10" fill="#3a3632" text-anchor="middle" font-weight="600" font-family="'IBM Plex Sans',sans-serif">C</text>
      </svg>
      <div class="vis-caption" data-lang="en">Asymmetric (A<sub>ij</sub> ≠ A<sub>ji</sub>). E.g. Twitter follows, citations.</div>
      <div class="vis-caption" data-lang="zh">非对称（A<sub>ij</sub> ≠ A<sub>ji</sub>）。如：关注、引用。</div>
    </div>
    <div class="vis-panel">
      <div class="vis-label" data-lang="en">Weighted</div>
      <div class="vis-label" data-lang="zh">加权</div>
      <svg viewBox="0 0 160 100" xmlns="http://www.w3.org/2000/svg">
        <line x1="40" y1="30" x2="120" y2="30" stroke="#c29a3d" stroke-width="5" opacity=".6"/>
        <line x1="40" y1="30" x2="80" y2="80" stroke="#c29a3d" stroke-width="1.5" opacity=".4"/>
        <line x1="120" y1="30" x2="80" y2="80" stroke="#c29a3d" stroke-width="3" opacity=".5"/>
        <circle cx="40" cy="30" r="12" fill="#c29a3d" opacity=".25" stroke="#c29a3d" stroke-width="1.5"/>
        <circle cx="120" cy="30" r="12" fill="#c29a3d" opacity=".25" stroke="#c29a3d" stroke-width="1.5"/>
        <circle cx="80" cy="80" r="12" fill="#c29a3d" opacity=".25" stroke="#c29a3d" stroke-width="1.5"/>
        <text x="40" y="34" font-size="10" fill="#3a3632" text-anchor="middle" font-weight="600" font-family="'IBM Plex Sans',sans-serif">A</text>
        <text x="120" y="34" font-size="10" fill="#3a3632" text-anchor="middle" font-weight="600" font-family="'IBM Plex Sans',sans-serif">B</text>
        <text x="80" y="84" font-size="10" fill="#3a3632" text-anchor="middle" font-weight="600" font-family="'IBM Plex Sans',sans-serif">C</text>
        <text x="80" y="22" font-size="9" fill="#6b6560" text-anchor="middle" font-family="'IBM Plex Sans',sans-serif">w=5</text>
        <text x="52" y="62" font-size="9" fill="#6b6560" text-anchor="middle" font-family="'IBM Plex Sans',sans-serif">w=1</text>
        <text x="108" y="62" font-size="9" fill="#6b6560" text-anchor="middle" font-family="'IBM Plex Sans',sans-serif">w=3</text>
      </svg>
      <div class="vis-caption" data-lang="en">A<sub>ij</sub> ∈ ℝ (continuous). E.g. trade volume between countries.</div>
      <div class="vis-caption" data-lang="zh">A<sub>ij</sub> ∈ ℝ（连续值）。如：国家间贸易量。</div>
    </div>
  </div>
</div>

<!-- SLIDE: Who Is Important -->
<div class="slide" id="slide-centrality">
  <div class="slide-num" data-lang="en">Part 1 · Slide 3</div>
  <div class="slide-num" data-lang="zh">第一部分 · 第 3 页</div>
  <h2 data-lang="en">Who Is "Important"? Three Answers</h2>
  <h2 data-lang="zh">谁"重要"？三种回答</h2>

  <p class="method-desc" data-lang="en">"Importance" depends on what you mean. Click each measure below — watch the node sizes change and read why.</p>
  <p class="method-desc" data-lang="zh">"重要"取决于你的定义。点击下方每个指标——观察节点大小变化，阅读原因。</p>

  <!-- VIS: Interactive centrality network -->
  <div class="cent-btns">
    <button class="cent-btn active" onclick="showCent('degree')" data-lang="en">Degree</button>
    <button class="cent-btn active" onclick="showCent('degree')" data-lang="zh">度中心性</button>
    <button class="cent-btn" onclick="showCent('between')" data-lang="en">Betweenness</button>
    <button class="cent-btn" onclick="showCent('between')" data-lang="zh">中介中心性</button>
    <button class="cent-btn" onclick="showCent('eigen')" data-lang="en">Eigenvector</button>
    <button class="cent-btn" onclick="showCent('eigen')" data-lang="zh">特征向量</button>
  </div>
  <div class="vis-panel" style="max-width:540px">
    <svg id="cent-svg" viewBox="0 0 400 180" xmlns="http://www.w3.org/2000/svg" style="font-family:'IBM Plex Sans',sans-serif">
      <line x1="80" y1="60" x2="200" y2="50" stroke="#c29a3d" stroke-width="1.5" opacity=".4"/>
      <line x1="80" y1="60" x2="140" y2="140" stroke="#c29a3d" stroke-width="1.5" opacity=".4"/>
      <line x1="200" y1="50" x2="140" y2="140" stroke="#c29a3d" stroke-width="1.5" opacity=".4"/>
      <line x1="200" y1="50" x2="290" y2="100" stroke="#c29a3d" stroke-width="1.5" opacity=".4"/>
      <line x1="290" y1="100" x2="360" y2="140" stroke="#c29a3d" stroke-width="1.5" opacity=".4"/>
      <circle id="cn-alice" cx="80" cy="60" r="18" fill="#c29a3d" opacity=".3" stroke="#c29a3d" stroke-width="2"/>
      <text x="80" y="64" font-size="11" fill="#3a3632" text-anchor="middle" font-weight="600">Alice</text>
      <circle id="cn-bob" cx="200" cy="50" r="24" fill="#c29a3d" opacity=".5" stroke="#c29a3d" stroke-width="2"/>
      <text x="200" y="54" font-size="11" fill="#3a3632" text-anchor="middle" font-weight="600">Bob</text>
      <circle id="cn-carol" cx="140" cy="140" r="18" fill="#c29a3d" opacity=".3" stroke="#c29a3d" stroke-width="2"/>
      <text x="140" y="144" font-size="11" fill="#3a3632" text-anchor="middle" font-weight="600">Carol</text>
      <circle id="cn-dave" cx="290" cy="100" r="18" fill="#c29a3d" opacity=".3" stroke="#c29a3d" stroke-width="2"/>
      <text x="290" y="104" font-size="11" fill="#3a3632" text-anchor="middle" font-weight="600">Dave</text>
      <circle id="cn-eve" cx="360" cy="140" r="12" fill="#c29a3d" opacity=".15" stroke="#c29a3d" stroke-width="2"/>
      <text x="360" y="144" font-size="11" fill="#3a3632" text-anchor="middle" font-weight="600">Eve</text>
    </svg>
    <div class="vis-caption" id="cent-caption" data-lang="en">Degree: node size = number of connections. Bob has the most (3).</div>
    <div class="vis-caption" id="cent-caption-zh" data-lang="zh">度中心性：节点大小 = 连接数。Bob 最多（3 条）。</div>
  </div>

  <!-- Dynamic explanation area — updated by JS -->
  <div id="cent-detail-en" class="method-desc" data-lang="en"><strong>Degree centrality</strong> — simply count edges: C<sub>D</sub>(i) = k<sub>i</sub> / (n−1). <em>Intuition:</em> who has the most direct contacts? Bob wins with 3. The most popular kid at the party. <em>Theory:</em> based on the adjacency matrix row sum, normalized by max possible ties.</div>
  <div id="cent-detail-zh" class="method-desc" data-lang="zh"><strong>度中心性</strong>——直接数边：C<sub>D</sub>(i) = k<sub>i</sub> / (n−1)。<em>直觉：</em>谁的直接联系最多？Bob 以 3 条胜出。派对上最受欢迎的人。<em>理论：</em>基于邻接矩阵行和，除以最大可能连接数进行标准化。</div>

  <div class="method-when" data-lang="en"><strong>Key insight:</strong> No single "right" measure — each captures a different structural role. Choose based on your research question.</div>
  <div class="method-when" data-lang="zh"><strong>核心洞见：</strong>没有单一"正确"的指标——每个捕捉不同的结构角色。根据研究问题选择。</div>
</div>

<!-- SLIDE: Communities -->
<div class="slide" id="slide-community">
  <div class="slide-num" data-lang="en">Part 1 · Slide 4</div>
  <div class="slide-num" data-lang="zh">第一部分 · 第 4 页</div>
  <h2 data-lang="en">Finding Groups: Community Detection</h2>
  <h2 data-lang="zh">发现群体：社区检测</h2>

  <p class="method-desc" data-lang="en">Real networks are cliquish — dense within groups, sparse between them. Community detection algorithms discover these groups automatically from connections alone, no labels needed.</p>
  <p class="method-desc" data-lang="zh">真实网络是小团体的——组内密集、组间稀疏。社区检测算法仅从连接数据就能自动发现这些群体，不需要标签。</p>

  <!-- VIS: Community network -->
  <div class="vis-row">
    <div class="vis-panel" style="max-width:540px">
      <svg viewBox="0 0 400 180" xmlns="http://www.w3.org/2000/svg" style="font-family:'IBM Plex Sans',sans-serif">
        <line x1="60" y1="50" x2="120" y2="40" stroke="#b85450" stroke-width="2" opacity=".4"/>
        <line x1="60" y1="50" x2="90" y2="110" stroke="#b85450" stroke-width="2" opacity=".4"/>
        <line x1="120" y1="40" x2="90" y2="110" stroke="#b85450" stroke-width="2" opacity=".4"/>
        <line x1="120" y1="40" x2="150" y2="100" stroke="#b85450" stroke-width="2" opacity=".4"/>
        <line x1="60" y1="50" x2="150" y2="100" stroke="#b85450" stroke-width="2" opacity=".4"/>
        <line x1="270" y1="45" x2="330" y2="50" stroke="#5b8c85" stroke-width="2" opacity=".4"/>
        <line x1="270" y1="45" x2="280" y2="110" stroke="#5b8c85" stroke-width="2" opacity=".4"/>
        <line x1="330" y1="50" x2="280" y2="110" stroke="#5b8c85" stroke-width="2" opacity=".4"/>
        <line x1="330" y1="50" x2="350" y2="120" stroke="#5b8c85" stroke-width="2" opacity=".4"/>
        <line x1="280" y1="110" x2="350" y2="120" stroke="#5b8c85" stroke-width="2" opacity=".4"/>
        <line x1="150" y1="100" x2="270" y2="45" stroke="#c29a3d" stroke-width="1.5" stroke-dasharray="6,4" opacity=".6"/>
        <circle cx="60" cy="50" r="14" fill="#b85450" opacity=".25" stroke="#b85450" stroke-width="1.5"/>
        <circle cx="120" cy="40" r="14" fill="#b85450" opacity=".25" stroke="#b85450" stroke-width="1.5"/>
        <circle cx="90" cy="110" r="14" fill="#b85450" opacity=".25" stroke="#b85450" stroke-width="1.5"/>
        <circle cx="150" cy="100" r="14" fill="#b85450" opacity=".25" stroke="#b85450" stroke-width="1.5"/>
        <circle cx="270" cy="45" r="14" fill="#5b8c85" opacity=".25" stroke="#5b8c85" stroke-width="1.5"/>
        <circle cx="330" cy="50" r="14" fill="#5b8c85" opacity=".25" stroke="#5b8c85" stroke-width="1.5"/>
        <circle cx="280" cy="110" r="14" fill="#5b8c85" opacity=".25" stroke="#5b8c85" stroke-width="1.5"/>
        <circle cx="350" cy="120" r="14" fill="#5b8c85" opacity=".25" stroke="#5b8c85" stroke-width="1.5"/>
        <text x="95" y="155" font-size="11" fill="#b85450" text-anchor="middle" font-weight="600">Community A</text>
        <text x="305" y="155" font-size="11" fill="#5b8c85" text-anchor="middle" font-weight="600">Community B</text>
        <text x="210" y="68" font-size="9" fill="#c29a3d" text-anchor="middle" font-style="italic">bridge</text>
      </svg>
      <div class="vis-caption" data-lang="en">Dense within groups, sparse between — the dashed line is the only bridge</div>
      <div class="vis-caption" data-lang="zh">组内密集、组间稀疏——虚线是唯一的桥梁</div>
    </div>
  </div>

  <p class="method-desc" data-lang="en"><em>Intuition:</em> find groups where members are more connected to each other than to outsiders — like identifying lunch tables in a high school cafeteria. The algorithm doesn't need labels; it discovers structure purely from the pattern of connections. This is powerful because the groups it finds often reveal real social divisions that surveys miss.</p>
  <p class="method-desc" data-lang="zh"><em>直觉：</em>找到成员之间联系比对外联系更紧密的群体——就像识别高中食堂里的午餐桌。算法不需要标签，纯粹从连接模式中发现结构。这很有用，因为它找到的群体常常揭示问卷遗漏的真实社会划分。</p>
</div>

<!-- SLIDE: Network Methods Overview -->
<div class="slide" id="slide-methods-overview">
  <div class="slide-num" data-lang="en">Part 1 · Slide 5</div>
  <div class="slide-num" data-lang="zh">第一部分 · 第 5 页</div>
  <h2 data-lang="en">From Description to Inference</h2>
  <h2 data-lang="zh">从描述到推断</h2>

  <p class="method-desc" data-lang="en">Network methods fall into two layers. <strong>Descriptive methods</strong> tell you <em>what</em> the network looks like; <strong>inferential models</strong> test <em>why</em> it looks that way.</p>
  <p class="method-desc" data-lang="zh">网络方法分两层。<strong>描述性方法</strong>告诉你网络<em>长什么样</em>；<strong>推断模型</strong>检验它<em>为什么</em>长这样。</p>

  <h3 data-lang="en">Descriptive: What Does the Network Look Like?</h3>
  <h3 data-lang="zh">描述层：网络长什么样？</h3>
  <div class="check-grid" style="grid-template-columns:1fr 1fr">
    <div class="check-card">
      <div class="check-icon">01</div>
      <div class="check-title" data-lang="en">Centrality Measures</div>
      <div class="check-title" data-lang="zh">中心性指标</div>
      <div class="check-desc" data-lang="en">Who is important? Degree, betweenness, eigenvector — each captures a different structural role. Covered in Slide 3.</div>
      <div class="check-desc" data-lang="zh">谁重要？度、中介、特征向量——各自捕捉不同的结构角色。见第 3 页。</div>
    </div>
    <div class="check-card">
      <div class="check-icon">02</div>
      <div class="check-title" data-lang="en">Community Detection</div>
      <div class="check-title" data-lang="zh">社区检测</div>
      <div class="check-desc" data-lang="en">Where are the clusters? Algorithms like <strong>Louvain</strong> optimize modularity to find dense subgroups automatically. Fast, scalable, widely used. Covered in Slide 4.</div>
      <div class="check-desc" data-lang="zh">聚类在哪？<strong>Louvain</strong> 等算法优化模块性，自动发现密集子群。快速、可扩展、应用广泛。见第 4 页。</div>
    </div>
  </div>

  <h3 data-lang="en">Inferential: Why Does the Network Look This Way?</h3>
  <h3 data-lang="zh">推断层：网络为什么长这样？</h3>
  <div class="check-grid">
    <div class="check-card">
      <div class="check-icon">Q</div>
      <div class="check-title" data-lang="en">QAP</div>
      <div class="check-title" data-lang="zh">QAP</div>
      <div class="check-desc" data-lang="en">Do two networks correlate? Permutation-based test. E.g. do students who study together also hang out socially? Shuffle one matrix thousands of times and check if the real correlation is unusually strong.</div>
      <div class="check-desc" data-lang="zh">两个网络是否相关？基于置换的检验。例如：一起学习的学生是否也在课外社交？把一个矩阵洗牌上千次，看真实相关是否异常强。</div>
    </div>
    <div class="check-card">
      <div class="check-icon">E</div>
      <div class="check-title" data-lang="en">ERGM</div>
      <div class="check-title" data-lang="zh">ERGM</div>
      <div class="check-desc" data-lang="en">What drives tie formation? E.g. do students seek help from same-major peers (homophily), or from high-GPA classmates (popularity)? Like logistic regression for networks. <strong>Today's focus.</strong></div>
      <div class="check-desc" data-lang="zh">什么驱动关系形成？例如：学生倾向找同专业的人请教（同质性），还是找 GPA 高的人（人气效应）？相当于网络的逻辑回归。<strong>今天的重点。</strong></div>
    </div>
    <div class="check-card">
      <div class="check-icon">L</div>
      <div class="check-title" data-lang="en">Latent Space</div>
      <div class="check-title" data-lang="zh">潜在空间模型</div>
      <div class="check-desc" data-lang="en">Embed nodes in a latent space where proximity predicts ties. E.g. map a classroom's friendship network into 2D — students close in the space are likely friends, revealing cliques invisible in raw data.</div>
      <div class="check-desc" data-lang="zh">将节点嵌入潜在空间，距离近的更可能有关系。例如：把一个班级的友谊网络映射到二维空间——空间中靠近的学生更可能是朋友，揭示原始数据中看不到的小圈子。</div>
    </div>
  </div>

  <div class="method-when" data-lang="en"><strong>Today we focus on ERGM</strong> — our paper (Köhler et al. 2024) uses it to ask: what drives advice-seeking ties in an organization? Part 2 walks through this step by step.</div>
  <div class="method-when" data-lang="zh"><strong>今天我们聚焦 ERGM</strong>——我们要拆解的论文（Köhler et al. 2024）用它来问：什么驱动了组织中的求助关系？第二部分逐步拆解。</div>
</div>

<!-- SLIDE: When to Use -->
<div class="slide" id="slide-when">
  <div class="slide-num" data-lang="en">Part 1 · Slide 6</div>
  <div class="slide-num" data-lang="zh">第一部分 · 第 6 页</div>
  <h2 data-lang="en">Should You Use Network Analysis?</h2>
  <h2 data-lang="zh">你应该用网络分析吗？</h2>

  <p class="method-desc" data-lang="en">If you can answer "yes" to all three, network analysis is likely the right tool:</p>
  <p class="method-desc" data-lang="zh">如果三个问题都能答"是"，网络分析很可能是合适的工具：</p>

  <!-- VIS: Decision checklist -->
  <div class="check-grid">
    <div class="check-card">
      <div class="check-icon">01</div>
      <div class="check-title" data-lang="en">Relational Data?</div>
      <div class="check-title" data-lang="zh">关系数据？</div>
      <div class="check-desc" data-lang="en">Your data has pairs (who↔whom). If each row is an independent person with no ties, standard methods may suffice.</div>
      <div class="check-desc" data-lang="zh">你的数据包含配对（谁↔谁）。如果每行是独立个体且没有联系，标准方法可能足够。</div>
    </div>
    <div class="check-card">
      <div class="check-icon">02</div>
      <div class="check-title" data-lang="en">Position Matters?</div>
      <div class="check-title" data-lang="zh">位置重要？</div>
      <div class="check-desc" data-lang="en">Structural position (connections, brokerage, community) shapes outcomes beyond individual attributes. Network analysis captures what regression cannot.</div>
      <div class="check-desc" data-lang="zh">结构位置（连接、中介角色、社区归属）影响结果，超越个体属性。网络分析能捕捉回归无法捕捉的东西。</div>
    </div>
    <div class="check-card">
      <div class="check-icon">03</div>
      <div class="check-title" data-lang="en">Dependence Is the Story?</div>
      <div class="check-title" data-lang="zh">依赖性是核心？</div>
      <div class="check-desc" data-lang="en">Observations are <em>not</em> independent — your friend's behavior affects yours, one country's policy spills over to neighbors.</div>
      <div class="check-desc" data-lang="zh">观测<em>不</em>独立——你朋友的行为影响你，一国的政策溢出到邻国。</div>
    </div>
  </div>
</div>

<!-- SLIDE: Steps to a Network Analysis Paper -->
<div class="slide" id="slide-steps">
  <div class="slide-num" data-lang="en">Part 1 · Slide 7</div>
  <div class="slide-num" data-lang="zh">第一部分 · 第 7 页</div>
  <h2 data-lang="en">From Idea to Paper: A Network Analysis Workflow</h2>
  <h2 data-lang="zh">从想法到论文：网络分析的工作流程</h2>

  <div class="check-grid">
    <div class="check-card">
      <div class="check-icon">01</div>
      <div class="check-title" data-lang="en">Define</div>
      <div class="check-title" data-lang="zh">定义</div>
      <div class="check-desc" data-lang="en">What are nodes and edges? E.g. "Nodes = students; edge = asked for help at least twice." The most important decision.</div>
      <div class="check-desc" data-lang="zh">节点和边是什么？如"节点 = 学生；边 = 至少请教过两次"。最重要的决定。</div>
    </div>
    <div class="check-card">
      <div class="check-icon">02</div>
      <div class="check-title" data-lang="en">Construct</div>
      <div class="check-title" data-lang="zh">构建</div>
      <div class="check-desc" data-lang="en">Build edge list or adjacency matrix from survey / archival data. Visualize early to spot errors.</div>
      <div class="check-desc" data-lang="zh">从问卷或档案数据建立边表/邻接矩阵。尽早可视化以发现问题。</div>
    </div>
    <div class="check-card">
      <div class="check-icon">03</div>
      <div class="check-title" data-lang="en">Describe</div>
      <div class="check-title" data-lang="zh">描述</div>
      <div class="check-desc" data-lang="en">Density, centrality, communities — the network's descriptive statistics.</div>
      <div class="check-desc" data-lang="zh">密度、中心性、社区——网络的描述性统计。</div>
    </div>
  </div>
  <div class="check-grid" style="grid-template-columns:1fr 1fr">
    <div class="check-card">
      <div class="check-icon">04</div>
      <div class="check-title" data-lang="en">Model</div>
      <div class="check-title" data-lang="zh">建模</div>
      <div class="check-desc" data-lang="en">Test hypotheses with ERGM, QAP, or latent space models (see Slide 5).</div>
      <div class="check-desc" data-lang="zh">用 ERGM、QAP 或潜在空间模型检验假设（见第 5 页）。</div>
    </div>
    <div class="check-card">
      <div class="check-icon">05</div>
      <div class="check-title" data-lang="en">Robustness</div>
      <div class="check-title" data-lang="zh">稳健性</div>
      <div class="check-desc" data-lang="en">Vary thresholds and measures; remove key nodes to test stability.</div>
      <div class="check-desc" data-lang="zh">改变阈值和指标，移除关键节点测试结果是否稳定。</div>
    </div>
  </div>

  <div class="method-when" data-lang="en"><strong>Now let's see this workflow in action.</strong> Part 2 walks through a real published paper — from research question to findings.</div>
  <div class="method-when" data-lang="zh"><strong>现在让我们看看这个流程的实战。</strong>第二部分将逐步拆解一篇真实发表的论文——从研究问题到发现。</div>
</div>

<hr class="section-divider pres-hide">

<!-- ═══════════════════════════════════════════════════ -->
<!--  PART 2: A PAPER WALKTHROUGH                       -->
<!-- ═══════════════════════════════════════════════════ -->

<!-- SLIDE: Part 2 Title -->
<div class="slide" id="slide-part2">
  <div class="slide-num" data-lang="en">Part 2</div>
  <div class="slide-num" data-lang="zh">第二部分</div>
  <h2 data-lang="en">Paper Walkthrough: Expertise &amp; Advice Networks</h2>
  <h2 data-lang="zh">论文拆解：专业知识与建议网络</h2>

  <p class="method-desc" data-lang="en">Köhler, Rausch, Biemann &amp; Büchsenschuss (2024). "Expertise and specialization in organizations: a social network analysis." <em>European Journal of Work and Organizational Psychology</em>, 34(2), 282–297. <a href="https://doi.org/10.1080/1359432X.2024.2387874" target="_blank">Open Access</a></p>
  <p class="method-desc" data-lang="zh">Köhler, Rausch, Biemann &amp; Büchsenschuss (2024). "组织中的专业知识与专业化：一项社会网络分析。" <em>European Journal of Work and Organizational Psychology</em>, 34(2), 282–297. <a href="https://doi.org/10.1080/1359432X.2024.2387874" target="_blank">开放获取</a></p>

  <p class="method-desc" data-lang="en"><em>Core question:</em> Are you sought for advice because you're truly skilled — or simply because you're well-known?</p>
  <p class="method-desc" data-lang="zh"><em>核心问题：</em>别人来请教你，是因为你真的强——还是只因为你出名？</p>
</div>

<!-- SLIDE: Research Question & Core Concepts -->
<div class="slide" id="slide-rq">
  <div class="slide-num" data-lang="en">Part 2 · Slide 1</div>
  <div class="slide-num" data-lang="zh">第二部分 · 第 1 页</div>
  <h2 data-lang="en">Research Question &amp; Core Concepts</h2>
  <h2 data-lang="zh">研究问题与核心概念</h2>

  <p class="method-desc" data-lang="en">This paper asks: <strong>What drives the formation of advice-seeking ties in an organizational network?</strong> Two competing explanations:</p>
  <p class="method-desc" data-lang="zh">这篇论文问的是：<strong>什么驱动了组织中求助关系的形成？</strong>两种竞争性解释：</p>

  <div class="check-grid" style="grid-template-columns:1fr 1fr">
    <div class="check-card">
      <div class="check-icon">A</div>
      <div class="check-title" data-lang="en">Individual Attributes</div>
      <div class="check-title" data-lang="zh">个体属性</div>
      <div class="check-desc" data-lang="en"><strong>Expertise</strong> and <strong>specialization</strong> — people seek out whoever is truly skilled. <em>Example:</em> you ask the best Excel person about Excel, the best writer about writing.</div>
      <div class="check-desc" data-lang="zh"><strong>专业知识</strong>和<strong>专业化</strong>——人们找真正有本事的人。<em>例子：</em>Excel 问题找 Excel 最强的人，写作问题找写作最好的人。</div>
    </div>
    <div class="check-card">
      <div class="check-icon">B</div>
      <div class="check-title" data-lang="en">Structural Effects</div>
      <div class="check-title" data-lang="zh">结构效应</div>
      <div class="check-desc" data-lang="en"><strong>Reciprocity</strong> — you helped me, so I ask you back. <strong>Homophily</strong> — I ask people similar to me (same department, same age). <em>Example:</em> you don't ask the best person, you ask the person you already know.</div>
      <div class="check-desc" data-lang="zh"><strong>互惠性</strong>——你帮过我，我也来找你。<strong>同质性</strong>——我找和我相似的人（同部门、同年龄）。<em>例子：</em>你不找最强的人，而是找已经认识的人。</div>
    </div>
  </div>

  <div class="check-grid" style="grid-template-columns:1fr 1fr">
    <div class="check-card">
      <div class="check-icon">E</div>
      <div class="check-title" data-lang="en">Expert (Expertise)</div>
      <div class="check-title" data-lang="zh">专家（Expertise）</div>
      <div class="check-desc" data-lang="en">Sustained superior performance — both breadth and depth, developed through long-term accumulation. <em>Example:</em> a senior underwriter who masters all types of insurance products. <em>Network prediction:</em> central — sought by many people on many topics.</div>
      <div class="check-desc" data-lang="zh">持续卓越的表现——广度和深度都高，通过长期积累发展。<em>例子：</em>一个精通所有险种的资深核保师。<em>网络预测：</em>处于中心——很多人在很多话题上找他。</div>
    </div>
    <div class="check-card">
      <div class="check-icon">S</div>
      <div class="check-title" data-lang="en">Specialist (Specialization)</div>
      <div class="check-title" data-lang="zh">专才（Specialization）</div>
      <div class="check-desc" data-lang="en">Mid-to-high competence on tasks others don't do — from division of labor, not necessarily long-term accumulation. <em>Example:</em> the only person who knows the legacy claims system. <em>Network prediction:</em> peripheral — only people with that specific problem come to you.</div>
      <div class="check-desc" data-lang="zh">对别人不做的任务有中高水平能力——来自分工，不一定需要长期积累。<em>例子：</em>公司里唯一懂旧理赔系统的人。<em>网络预测：</em>处于边缘——只有遇到那个具体问题的人才来找你。</div>
    </div>
  </div>

  <div class="method-when" data-lang="en"><strong>Why network analysis?</strong> Advice-seeking is inherently relational (who asks whom) and non-independent (if A asks B, B is more likely to ask A back). Standard regression ignores this interdependence — ERGM is designed for it.</div>
  <div class="method-when" data-lang="zh"><strong>为什么用网络分析？</strong>建议寻求本质上是关系性的（谁问谁）且非独立的（A 问了 B，B 更可能反过来问 A）。标准回归忽略了这种相互依赖——ERGM 就是为此设计的。</div>
</div>

<!-- SLIDE: Data as Network -->
<div class="slide" id="slide-data">
  <div class="slide-num" data-lang="en">Part 2 · Slide 2</div>
  <div class="slide-num" data-lang="zh">第二部分 · 第 2 页</div>
  <h2 data-lang="en">From Raw Data to a Network</h2>
  <h2 data-lang="zh">从原始数据到网络</h2>

  <div class="check-grid" style="grid-template-columns:1fr 1fr">
    <div class="check-card">
      <div class="check-icon">01</div>
      <div class="check-title" data-lang="en">Who Was Studied</div>
      <div class="check-title" data-lang="zh">研究对象</div>
      <div class="check-desc" data-lang="en">344 employees in a global insurance company's risk analysis division. 78% responded to the survey. Average age 47, average tenure 11 years, roughly gender-balanced.</div>
      <div class="check-desc" data-lang="zh">一家全球保险公司风险分析部门的 344 名员工。78% 回复了问卷。平均年龄 47 岁，平均工龄 11 年，男女各半。</div>
    </div>
    <div class="check-card">
      <div class="check-icon">02</div>
      <div class="check-title" data-lang="en">How the Network Was Built</div>
      <div class="check-title" data-lang="zh">网络怎么建的</div>
      <div class="check-desc" data-lang="en">Each person was asked: "Who do you go to for advice?" and could name up to 5 people — separately for 3 skill areas (core insurance, software, social). All individual answers were then combined into one organization-wide directed network: A→B means "A asks B." Only yes/no (binary), no frequency. Result: 535 advice ties total across 344 people — very sparse (density .0045), meaning most possible connections don't exist.</div>
      <div class="check-desc" data-lang="zh">每个人被问："你找谁请教？"最多填 5 个人——分别针对 3 个技能领域（核心保险、软件、社交）。所有人的回答汇总成一张全组织的有向网络：A→B 表示"A 找 B 请教"。只记录有没有（二元），不记频率。结果：344 人之间共 535 条求助关系——非常稀疏（密度 .0045），意味着绝大多数可能的连接并不存在。</div>
    </div>
  </div>
  <div class="check-grid">
    <div class="check-card">
      <div class="check-icon">03</div>
      <div class="check-title" data-lang="en">Data Source: Company Records</div>
      <div class="check-title" data-lang="zh">数据来源：公司档案</div>
      <div class="check-desc" data-lang="en">Age, gender, tenure, job level, leadership responsibility — objective facts from the HR database.</div>
      <div class="check-desc" data-lang="zh">年龄、性别、工龄、职级、是否有领导责任——来自 HR 数据库的客观信息。</div>
    </div>
    <div class="check-card">
      <div class="check-icon">04</div>
      <div class="check-title" data-lang="en">Data Source: Questionnaire</div>
      <div class="check-title" data-lang="zh">数据来源：问卷</div>
      <div class="check-desc" data-lang="en">29 skills rated on a self-assessment scale (18 core insurance + 7 software + 4 social), plus "I consider myself an expert / specialist" scales.</div>
      <div class="check-desc" data-lang="zh">29 项技能自评（18 项核心保险 + 7 项软件 + 4 项社交），加上"我认为自己是专家/专才"的量表。</div>
    </div>
    <div class="check-card">
      <div class="check-icon">05</div>
      <div class="check-title" data-lang="en">Data Source: Network Nomination</div>
      <div class="check-title" data-lang="zh">数据来源：网络提名</div>
      <div class="check-desc" data-lang="en">"Who do you ask for advice on [core / software / social] skills?" — up to 5 names per skill area. This is what generates the network edges.</div>
      <div class="check-desc" data-lang="zh">"在[核心/软件/社交]技能方面你找谁请教？"——每个领域最多填 5 个名字。这就是网络边的来源。</div>
    </div>
  </div>
</div>

<!-- SLIDE: Three-Study Design + Methods -->
<div class="slide" id="slide-methods">
  <div class="slide-num" data-lang="en">Part 2 · Slide 3</div>
  <div class="slide-num" data-lang="zh">第二部分 · 第 3 页</div>
  <h2 data-lang="en">Method: Three Studies in One Paper</h2>
  <h2 data-lang="zh">方法：一篇论文中的三个研究</h2>

  <div class="check-grid">
    <div class="check-card">
      <div class="check-icon">01</div>
      <div class="check-title" data-lang="en">Spearman Correlations</div>
      <div class="check-title" data-lang="zh">Spearman 相关</div>
      <div class="check-desc" data-lang="en"><em>Question:</em> If someone is frequently asked for insurance advice, are they also asked about software and social skills — even if they aren't actually good at those? If yes, that's a "halo effect": reputation in one area spills over to all areas.</div>
      <div class="check-desc" data-lang="zh"><em>问题：</em>如果一个人经常被请教保险问题，他是否也会被请教软件和社交问题——即使他在那些方面并不擅长？如果是，这就是"光环效应"：一个领域的声誉溢出到了所有领域。</div>
    </div>
    <div class="check-card">
      <div class="check-icon">02</div>
      <div class="check-title" data-lang="en">ERGM</div>
      <div class="check-title" data-lang="zh">ERGM</div>
      <div class="check-desc" data-lang="en"><em>Question:</em> What drives advice ties after controlling for network structure? Built in 3 steps: baseline → endogenous structure → node attributes. Software: R <code>ergm</code>.</div>
      <div class="check-desc" data-lang="zh"><em>问题：</em>控制网络结构后，什么驱动求助关系？分 3 步构建：基线 → 内生结构 → 节点属性。软件：R <code>ergm</code>。</div>
    </div>
    <div class="check-card">
      <div class="check-icon">03</div>
      <div class="check-title" data-lang="en">Optimal Matching</div>
      <div class="check-title" data-lang="zh">最优匹配</div>
      <div class="check-desc" data-lang="en"><em>Question:</em> Do real skill profiles match theoretical expert/specialist profiles? Computes "distance" between actual and ideal, then correlates with self-assessments and centrality.</div>
      <div class="check-desc" data-lang="zh"><em>问题：</em>真实技能画像与理论画像匹配吗？计算实际与理论的"距离"，再与自评量表和中心度做相关。</div>
    </div>
  </div>

  <div class="method-when" data-lang="en"><strong>Logic:</strong> Study 1 reveals the pattern → Study 2 tests drivers → Study 3 validates categories.</div>
  <div class="method-when" data-lang="zh"><strong>逻辑：</strong>研究一揭示模式 → 研究二检验驱动因素 → 研究三验证分类。</div>
</div>

<!-- SLIDE: Study 1 — Halo Effect -->
<div class="slide" id="slide-study1">
  <div class="slide-num" data-lang="en">Part 2 · Slide 4</div>
  <div class="slide-num" data-lang="zh">第二部分 · 第 4 页</div>
  <h2 data-lang="en">Study 1: The Halo Effect</h2>
  <h2 data-lang="zh">研究一：光环效应</h2>

  <p class="method-desc" data-lang="en"><strong>Finding:</strong> Correlations between in-degree centrality <em>across</em> the three skill domains are stronger than correlations between in-degree and actual skill levels <em>within</em> each domain.</p>
  <p class="method-desc" data-lang="zh"><strong>发现：</strong>不同技能领域的入度中心性<em>之间</em>的相关性，强于入度与该领域实际技能水平<em>之内</em>的相关性。</p>

  <p class="method-desc" data-lang="en"><strong>In plain language:</strong> If you're frequently asked for advice on insurance, you're also asked about software and social skills — regardless of your actual ability in those areas. Being sought reflects <em>reputation</em>, not domain-specific competence.</p>
  <p class="method-desc" data-lang="zh"><strong>通俗来说：</strong>如果你在保险问题上经常被请教，你在软件和社交问题上也会被请教——不管你在那些领域实际能力如何。被请教反映的是<em>声誉</em>，而非特定领域的能力。</p>
</div>

<!-- SLIDE: Study 2 — ERGM Results -->
<div class="slide" id="slide-study2">
  <div class="slide-num" data-lang="en">Part 2 · Slide 5</div>
  <div class="slide-num" data-lang="zh">第二部分 · 第 5 页</div>
  <h2 data-lang="en">Study 2: ERGM Results</h2>
  <h2 data-lang="zh">研究二：ERGM 结果</h2>

  <p class="method-desc" data-lang="en">ERGM coefficients read like logistic regression: a positive coefficient means the pattern is <em>more likely</em> than chance. After controlling for network structure, key findings from the full model (Model 3):</p>
  <p class="method-desc" data-lang="zh">ERGM 系数的读法与逻辑回归类似：正系数意味着相应模式比随机情况<em>更可能</em>出现。在控制网络结构后，完整模型（模型 3）的关键发现：</p>

  <div class="check-grid">
    <div class="check-card">
      <div class="check-icon">+</div>
      <div class="check-title" data-lang="en">Significant Positive</div>
      <div class="check-title" data-lang="zh">显著正效应</div>
      <div class="check-desc" data-lang="en"><strong>Reciprocity</strong> (strong); <strong>expertise</strong> (small positive); high <strong>core skill</strong> level; high <strong>software skill</strong> level. Experts get asked — but the effect is modest.</div>
      <div class="check-desc" data-lang="zh"><strong>互惠性</strong>（强）；<strong>专家身份</strong>（小正效应）；<strong>核心技能</strong>平均水平高；<strong>软件技能</strong>平均水平高。专家会被请教——但效应不大。</div>
    </div>
    <div class="check-card">
      <div class="check-icon">=</div>
      <div class="check-title" data-lang="en">Homophily Effects</div>
      <div class="check-title" data-lang="zh">同质性效应</div>
      <div class="check-desc" data-lang="en"><strong>Software skill similarity</strong> (very significant); <strong>similar tenure</strong>; <strong>same job level</strong>. People ask peers like themselves — especially for software skills.</div>
      <div class="check-desc" data-lang="zh"><strong>软件技能水平相近</strong>（非常显著）；<strong>工龄相近</strong>；<strong>职级相同</strong>。人们向与自己相似的同事求助——尤其是软件技能。</div>
    </div>
    <div class="check-card">
      <div class="check-icon">—</div>
      <div class="check-title" data-lang="en">Not Significant</div>
      <div class="check-title" data-lang="zh">不显著</div>
      <div class="check-desc" data-lang="en"><strong>Specialization</strong> (no effect — specialists are not approached more often); <strong>social skills</strong>. Also: <em>negative</em> two-path effect — people go directly to the source rather than through intermediaries.</div>
      <div class="check-desc" data-lang="zh"><strong>专才身份</strong>（无显著效应——专才并没有更常被请教）；<strong>社交技能</strong>。此外：简单中介路径为<em>负向</em>——人们倾向于直接找可能有答案的人，而不是通过中间人转介。</div>
    </div>
  </div>
</div>

<!-- SLIDE: Study 3 — Skill Profiles -->
<div class="slide" id="slide-study3">
  <div class="slide-num" data-lang="en">Part 2 · Slide 6</div>
  <div class="slide-num" data-lang="zh">第二部分 · 第 6 页</div>
  <h2 data-lang="en">Study 3: Do Real Skill Profiles Match Theory?</h2>
  <h2 data-lang="zh">研究三：真实技能画像与理论匹配吗？</h2>

  <p class="method-desc" data-lang="en">Using <strong>optimal matching</strong>, the authors computed the "distance" between each employee's actual skill profile and theoretically defined expert/specialist profiles, then correlated these distances with self-assessed scales and network centrality.</p>
  <p class="method-desc" data-lang="zh">通过<strong>最优匹配分析</strong>，作者计算每位员工的实际技能画像与理论专家/专才画像的"距离"，然后将这些距离与自评量表及网络中心度做相关。</p>

  <div class="check-grid" style="grid-template-columns:1fr 1fr">
    <div class="check-card">
      <div class="check-icon">E</div>
      <div class="check-title" data-lang="en">Expert Profile</div>
      <div class="check-title" data-lang="zh">专家画像</div>
      <div class="check-desc" data-lang="en">Results match theory. Higher self-rated expertise → skill profile closer to theoretical expert profile. More advice-seeking ties received → also closer. Theory and reality align.</div>
      <div class="check-desc" data-lang="zh">结果符合理论。自评专家程度越高 → 技能画像越接近理论专家画像。被请教越多 → 也越接近。理论与现实比较一致。</div>
    </div>
    <div class="check-card">
      <div class="check-icon">S</div>
      <div class="check-title" data-lang="en">Specialist Profile</div>
      <div class="check-title" data-lang="zh">专才画像</div>
      <div class="check-desc" data-lang="en">Results contradict theory. Higher self-rated specialization → skill profile <em>farther</em> from theoretical specialist profile. Likely because the sample contains two types of specialists, but the theoretical profile only fits one (task-specific within a shared domain), not the sole-responsible type.</div>
      <div class="check-desc" data-lang="zh">结果与理论矛盾。自评专才程度越高 → 技能画像反而离理论专才画像<em>越远</em>。原因可能是样本中同时存在两种专才，但理论画像只对应其中一种（共同领域内承担特定任务），不适用于整个领域只有他一人负责的那种。</div>
    </div>
  </div>
</div>

<!-- SLIDE: Contributions & Limitations -->
<div class="slide" id="slide-extend">
  <div class="slide-num" data-lang="en">Part 2 · Slide 7</div>
  <div class="slide-num" data-lang="zh">第二部分 · 第 7 页</div>
  <h2 data-lang="en">Contributions &amp; Limitations</h2>
  <h2 data-lang="zh">理论贡献与局限性</h2>

  <div class="check-grid">
    <div class="check-card">
      <div class="check-icon">+</div>
      <div class="check-title" data-lang="en">Contribution</div>
      <div class="check-title" data-lang="zh">贡献</div>
      <div class="check-desc" data-lang="en">Integrates expert/non-expert and specialist/generalist into one four-type framework. ERGM controls for network-endogenous factors, making analysis more rigorous than simple correlations.</div>
      <div class="check-desc" data-lang="zh">将专家/非专家和专才/通才整合为四类框架。ERGM 控制了网络内生因素，比单纯相关分析更严谨。</div>
    </div>
    <div class="check-card">
      <div class="check-icon">—</div>
      <div class="check-title" data-lang="en">Limitations</div>
      <div class="check-title" data-lang="zh">局限</div>
      <div class="check-desc" data-lang="en">Self-assessed skills (common method variance). 5-name cap may miss ties. Ego-network → full network introduces error. No physical proximity control. Cross-sectional — no causal direction.</div>
      <div class="check-desc" data-lang="zh">技能自评（共同方法变异）。5 人提名上限可能遗漏关系。自我网络推断全网有误差。未控制物理邻近。横截面设计无法判断因果方向。</div>
    </div>
    <div class="check-card">
      <div class="check-icon">?</div>
      <div class="check-title" data-lang="en">Extensions</div>
      <div class="check-title" data-lang="zh">延伸</div>
      <div class="check-desc" data-lang="en">TERGM for network evolution over time. Objective performance data instead of self-assessment. SAOM to separate selection from influence. Multi-organization comparison.</div>
      <div class="check-desc" data-lang="zh">TERGM 追踪网络动态演变。客观绩效数据替代自评。SAOM 区分选择与影响效应。多组织比较。</div>
    </div>
  </div>
</div>

<!-- SLIDE: Takeaway -->
<div class="slide" id="slide-end">
  <h2 data-lang="en">References</h2>
  <h2 data-lang="zh">参考资料</h2>

  <div class="check-grid" style="grid-template-columns:1fr 1fr">
    <div class="check-card">
      <div class="check-icon">01</div>
      <div class="check-title" data-lang="en">Today's Paper</div>
      <div class="check-title" data-lang="zh">今日论文</div>
      <div class="check-desc" data-lang="en">Köhler, Rausch, Biemann &amp; Büchsenschuss (2024). Expertise and specialization in organizations. <em>EJWOP</em>, 34(2), 282–297. <a href="https://doi.org/10.1080/1359432X.2024.2387874" target="_blank">Open Access</a></div>
      <div class="check-desc" data-lang="zh">Köhler, Rausch, Biemann &amp; Büchsenschuss (2024). 组织中的专业知识与专业化. <em>EJWOP</em>, 34(2), 282–297. <a href="https://doi.org/10.1080/1359432X.2024.2387874" target="_blank">开放获取</a></div>
    </div>
    <div class="check-card">
      <div class="check-icon">02</div>
      <div class="check-title" data-lang="en">ERGM Tutorial</div>
      <div class="check-title" data-lang="zh">ERGM 教程</div>
      <div class="check-desc" data-lang="en">Statnet team. ERGM tutorial with R code and worked examples. <a href="https://statnet.org/workshop-ergm/ergm_tutorial.html" target="_blank">statnet.org</a></div>
      <div class="check-desc" data-lang="zh">Statnet 团队. ERGM 教程，含 R 代码和实例. <a href="https://statnet.org/workshop-ergm/ergm_tutorial.html" target="_blank">statnet.org</a></div>
    </div>
    <div class="check-card">
      <div class="check-icon">03</div>
      <div class="check-title" data-lang="en">Methods Notebook</div>
      <div class="check-title" data-lang="zh">方法笔记本</div>
      <div class="check-desc" data-lang="en">Full network analysis reference page with math, code, and examples. <a href="/methods/reg-network.html">Network Analysis →</a></div>
      <div class="check-desc" data-lang="zh">完整的网络分析参考页面，含数学推导、代码和实例. <a href="/methods/reg-network.html">网络分析 →</a></div>
    </div>
    <div class="check-card">
      <div class="check-icon">04</div>
      <div class="check-title" data-lang="en">Textbook</div>
      <div class="check-title" data-lang="zh">教材</div>
      <div class="check-desc" data-lang="en">Wasserman &amp; Faust (1994). <em>Social Network Analysis: Methods and Applications</em>. Cambridge University Press.</div>
      <div class="check-desc" data-lang="zh">Wasserman &amp; Faust (1994). <em>社会网络分析：方法与应用</em>. 剑桥大学出版社.</div>
    </div>
  </div>
</div>

<!-- PAGE NAV -->
<div class="page-nav pres-hide">
  <a class="pn-link pn-prev" href="/methods/reg-network.html">
    <span class="pn-arrow">&larr;</span>
    <span><span class="pn-title" data-lang="en">Network Analysis</span><span class="pn-title" data-lang="zh">网络分析</span></span>
  </a>
</div>

<!-- ═══════════════════════════════════════════════════ -->
<!--  CENTRALITY INTERACTIVE                            -->
<!-- ═══════════════════════════════════════════════════ -->
<script>
(function(){
  const centData = {
    degree:  { alice:18, bob:24, carol:18, dave:18, eve:12,
      en:'Degree: node size = number of connections. Bob has the most (3).',
      zh:'度中心性：节点大小 = 连接数。Bob 最多（3 条）。',
      detailEn:'<strong>Degree centrality</strong> — simply count edges: C<sub>D</sub>(i) = k<sub>i</sub> / (n−1). <em>Intuition:</em> who has the most direct contacts? Bob wins with 3. The most popular kid at the party. <em>Theory:</em> based on the adjacency matrix row sum, normalized by max possible ties.',
      detailZh:'<strong>度中心性</strong>——直接数边：C<sub>D</sub>(i) = k<sub>i</sub> / (n−1)。<em>直觉：</em>谁的直接联系最多？Bob 以 3 条胜出。派对上最受欢迎的人。<em>理论：</em>基于邻接矩阵行和，除以最大可能连接数进行标准化。' },
    between: { alice:12, bob:22, carol:12, dave:22, eve:10,
      en:'Betweenness: Bob and Dave are bridges. Remove either and the network splits.',
      zh:'中介中心性：Bob 和 Dave 是桥梁。移除任一个，网络就断裂。',
      detailEn:'<strong>Betweenness centrality</strong> — count shortest paths passing through a node: C<sub>B</sub>(i) = Σ σ<sub>st</sub>(i) / σ<sub>st</sub>. <em>Intuition:</em> who is the gatekeeper? Dave controls all information flow to Eve. Remove him, and Eve is completely cut off. <em>Theory:</em> based on Brandes\' algorithm; measures how often a node lies on geodesic paths between all other pairs.',
      detailZh:'<strong>中介中心性</strong>——统计经过节点的最短路径数：C<sub>B</sub>(i) = Σ σ<sub>st</sub>(i) / σ<sub>st</sub>。<em>直觉：</em>谁是看门人？Dave 控制着通向 Eve 的所有信息流。移除他，Eve 完全孤立。<em>理论：</em>基于 Brandes 算法，衡量节点出现在所有其他节点对之间测地路径上的频率。' },
    eigen:   { alice:20, bob:24, carol:20, dave:16, eve:10,
      en:'Eigenvector: Alice & Carol are tied to the well-connected Bob, boosting their score.',
      zh:'特征向量：Alice 和 Carol 连接着高连接度的 Bob，提升了她们的得分。',
      detailEn:'<strong>Eigenvector centrality</strong> — your score depends on your neighbors\' scores: x<sub>i</sub> = (1/λ) Σ A<sub>ij</sub> x<sub>j</sub>. <em>Intuition:</em> it\'s not just who you know, but how well-connected they are. Alice knows Bob (the hub), making her more central than Eve who only knows the peripheral Dave. <em>Theory:</em> the leading eigenvector of the adjacency matrix A. Google\'s PageRank is a variant of this idea.',
      detailZh:'<strong>特征向量中心性</strong>——你的得分取决于邻居的得分：x<sub>i</sub> = (1/λ) Σ A<sub>ij</sub> x<sub>j</sub>。<em>直觉：</em>不只看你认识谁，还看他们的连接度。Alice 认识 Bob（枢纽），因此比只认识边缘 Dave 的 Eve 更中心。<em>理论：</em>邻接矩阵 A 的主特征向量。Google 的 PageRank 是此思想的变体。' }
  };
  window.showCent = function(type){
    var d = centData[type];
    if(!d) return;
    var ids = ['alice','bob','carol','dave','eve'];
    ids.forEach(function(n){
      var el = document.getElementById('cn-'+n);
      if(el){ el.setAttribute('r', d[n]); el.setAttribute('opacity', d[n]/30); }
    });
    var cap = document.getElementById('cent-caption');
    var capZh = document.getElementById('cent-caption-zh');
    if(cap) cap.textContent = d.en;
    if(capZh) capZh.textContent = d.zh;
    // Update detail text
    var detEn = document.getElementById('cent-detail-en');
    var detZh = document.getElementById('cent-detail-zh');
    if(detEn) detEn.innerHTML = d.detailEn;
    if(detZh) detZh.innerHTML = d.detailZh;
    // Update button states
    document.querySelectorAll('.cent-btn').forEach(function(b){ b.classList.remove('active'); });
    document.querySelectorAll('.cent-btn').forEach(function(b){
      if(b.textContent.toLowerCase().indexOf(type) >= 0 ||
         (type==='degree' && b.textContent.indexOf('度中心') >= 0) ||
         (type==='between' && b.textContent.indexOf('中介') >= 0) ||
         (type==='eigen' && b.textContent.indexOf('特征') >= 0))
        b.classList.add('active');
    });
  };
})();
</script>

<!-- ═══════════════════════════════════════════════════ -->
<!--  PRESENTATION ENGINE                               -->
<!-- ═══════════════════════════════════════════════════ -->
<script>
(function(){
  let presenting = false;
  let current = 0;
  let slides = [];
  let counter, hint, progress;

  window.togglePresentation = function(){
    if(!presenting) enterPresentation();
    else exitPresentation();
  };

  function enterPresentation(){
    slides = Array.from(document.querySelectorAll('.slide'));
    if(!slides.length) return;

    presenting = true;
    current = 0;
    document.body.classList.add('presenting');

    // Create counter
    counter = document.createElement('div');
    counter.className = 'slide-counter';
    document.body.appendChild(counter);

    // Create ESC hint
    hint = document.createElement('div');
    hint.className = 'pres-esc';
    hint.textContent = 'ESC to exit';
    document.body.appendChild(hint);

    // Create progress bar
    progress = document.createElement('div');
    progress.className = 'pres-progress';
    document.body.appendChild(progress);

    showSlide(0);
    document.addEventListener('keydown', onKey);
  }

  function exitPresentation(){
    presenting = false;
    document.body.classList.remove('presenting');
    slides.forEach(s => s.classList.remove('active'));
    if(counter) { counter.remove(); counter = null; }
    if(hint) { hint.remove(); hint = null; }
    if(progress) { progress.remove(); progress = null; }
    document.removeEventListener('keydown', onKey);
  }

  function showSlide(idx){
    slides.forEach(s => s.classList.remove('active'));
    current = Math.max(0, Math.min(idx, slides.length - 1));
    slides[current].classList.add('active');
    slides[current].scrollTop = 0;
    if(counter) counter.textContent = (current+1) + ' / ' + slides.length;
    if(progress) progress.style.width = ((current+1)/slides.length*100) + '%';
  }

  function onKey(e){
    if(e.key === 'ArrowRight' || e.key === 'ArrowDown' || e.key === ' '){
      e.preventDefault(); showSlide(current + 1);
    } else if(e.key === 'ArrowLeft' || e.key === 'ArrowUp'){
      e.preventDefault(); showSlide(current - 1);
    } else if(e.key === 'Escape'){
      exitPresentation();
    }
  }
})();
</script>
